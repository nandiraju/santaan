
<div class="parallax-element" data-stellar-background-ratio="0.5">
	<div class="big-text-panel text-center" style="color:white;">
		<h1 id="merchant-name">&nbsp;</h1>
		<p id="address_small" style="color:white;margin-top: -20px;">&nbsp;</p>
		<br />
	</div>

</div>

<div style="background-color: #fff;padding:20px;margin:0px;">
	<div class="container animated fadeInDown" style="margin-top: 0px;">
		<div class="row" id="overview_section">
			<div class="col-md-12 text-center">
				<h1 class="slickHeading" >Overview</h1>
				<p class="lead" id="overview_content">
					IVF CLINIC
				</p>
				<br />
			</div>
		</div>
	</div>
</div>

<div style="background-color: #efefef;">

	<div class="container" style="padding:50px 0px;">
		<div class="row" id="gallery_section" >
			<div class="col-md-12 text-center">
				<div class="row text-center" id="photo-gallery"></div>
			</div>
		</div>
	</div>
</div>

<div style="background-color: #fff;padding:5px;margin:0px;">
	<div class="container">
		<div class="row flex-container">
			<div class="col-md-12 text-center">
				<div style="padding:20px 0px;">
					<h1 class="slickHeading" style="color:#333;">The clinic is now </h1>
					<img class="" id="store_open" src="img/store_open.png" alt="Store status" width="150px"/>
					<br />
					<br />
				</div>
			</div>
		</div>
	</div>
</div>

<div style="background-color: #f5f5f5;padding:75px;margin:0px;">
	<div class="container">
		<div class="row flex-container" >
			<div class="col-md-6 text-center">
				<img src="https://cdn0.iconfinder.com/data/icons/ikooni-outline-free-basic/128/free-20-128.png" alt="" />
				<h1 class="slickHeading">Timings</h1>
				<p>
					The clinic operating hours during the weekdays and Weekends
				</p>
			</div>
			<div class="col-md-6 text-center">
				<div  id="timings_content" style="padding:10px;background-color: white;" class="card"></div>
			</div>
		</div>
	</div>
</div>

<div style="background-color: #fff;padding:75px;margin:0px;">
	<div class="container">
		<div class="row flex-container" id="phone_section">
			<div class="col-md-6 text-center">
				<h2 class="slickHeading" id="localphone_content"></h2>
				<h2 class="slickHeading" id="globalphone_content"></h2>
			</div>
			<div class="col-md-6 text-center">
				<img src="https://cdn0.iconfinder.com/data/icons/ikooni-outline-free-basic/128/free-13-128.png" alt="" />
				<h1 class="slickHeading">Phone</h1>
				<p>
					The local and international contact numbers to reach the clinic staff.
				</p>
			</div>
		</div>
	</div>
</div>

<div style="background-color: #f5f5f5;padding:75px;margin:0px;">
	<div class="container">
		<div class="row flex-container" id="website_section">
			<div class="col-xs-6 text-center">
				<img src="https://cdn0.iconfinder.com/data/icons/ikooni-outline-free-basic/128/free-25-128.png" alt="" />
				<h1 class="slickHeading">Website</h1>
				<p id="website_content"></p>
			</div>
			<div class="col-xs-6">
				<div class="device-mockup macbook">
					<div class="device">
						<div class="screen">
							<div id="website_image" style="height:100%;background: url('http://img.bitpixels.com/getthumbnail?code=95254&size=200&url=http://www.snapdeal.com') no-repeat top center;background-size:cover;box-shadow:inset 1px 2px 3px rgba(0,0,0,0.6);"></div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>

<div style="background-color: #fff;padding:75px;margin:0px;">
	<div class="container">
		<div class="row flex-container">
			<div class="col-sm-6 text-center">
				<div style="padding:5px;background-color: #f5f5f5;" class="card">
					<iframe id="map_view" style='' width="100%" height="300px;" frameborder="0" scrolling="no" marginheight="0" marginwidth="0"  src=""></iframe>
				</div>
			</div>
			<div class="col-sm-6 text-center" style="color:;">
				<img src="https://cdn0.iconfinder.com/data/icons/ikooni-outline-free-basic/128/free-04-128.png" alt="" />
				<h1>Address</h1>
				<p id="address_content"></p>
			</div>

		</div>
	</div>

</div>

<div style="background-color: #f5f5f5;padding:75px;margin:0px;">
	<div class="container" style="padding:20px 0px;">
		<div class="row">
			<div class="col-md-12 text-center">
				<img src="https://cdn0.iconfinder.com/data/icons/ikooni-outline-free-basic/128/free-02-128.png" alt="" />
				<h2 class="slickHeading" >Customer Reviews</h2>
				<p class="lead text-center" style="background-color: #f5f5f5;width:200px;margin:auto;padding:20px;">
					Overall rating
					<br>
					<img src="https://cdn1.iconfinder.com/data/icons/metroicons/black/favs.png" alt="" style="opacity:0.5;margin-bottom:10px;"/>
					<br />
					<span id="rating_text"><strong>3.5/5</strong></span>
				</p>
			</div>
		</div>

		<div class="row text-center m_row" id="reviews_holder" style="padding:10px;">

		</div>
	</div>
</div>

<!-- HIDDEN ELEMENTS START HERE -->

<div id="ONE_GALLERY_ITEM" style="display:none;">
	{{#images}}
	<a href="{{.}}" data-gallery> <div class="col-sm-4" style="border:2px solid white;height:300px;background: url({{.}}) no-repeat top center;background-size:cover;">

	</div> </a>
	<!-- a href="{{.}}" data-toggle="lightbox" data-gallery="multiimages"> <div class="col-sm-4" style="border:2px solid white;height:300px;background: url({{.}}) no-repeat center center;background-size:cover;"></div> </a -->
	{{/images}}
</div>

<div id="TIMING_TEMPLATE" style="display:none;">

	<table class="table table-condensed table-hover">
		<thead >
			<tr >
				<th class="text-center"> Day </th>
				<th class="text-center"> Time</th>
			</tr>
		</thead>
		<tbody>
			<!-- {{#times}} -->
			<tr data-original-title="TR here to view details">
				<td>{{day}}</td>
				<td> {{times}}</td>
			</tr>
			<!-- {{/times}} -->
		</tbody>
	</table>

</div>

<div id="REVIEW_TEMPLATE" style="display:none;">
	{{#reviews}}
	<div class="m_panel">
		<div class="review-body card" style="">
			<p class="lead" style="margin:5px;" class="text-left">
				- {{text}}
			</p>
			<p style="color:silver;margin:5px;" class="text-right">
				{{author_name}}
				<br />
				{{{stars}}}
			</p>
		</div>

	</div>
	{{/reviews}}
</div>

<!-- HOLDER FOR SLIDES -->
<div id="blueimp-gallery" class="blueimp-gallery blueimp-gallery-controls">
	<div class="slides"></div>
	<h3 class="title"></h3>
	<a class="prev">&lsaquo;</a>
	<a class="next">&rsaquo;</a>
	<a class="close">&times;</a>
	<a class="play-pause"></a>
	<ol class="indicator"></ol>
</div>

<script type="text/javascript">
	$(function() {
		//renderData($.jStorage.get("SELECTED_PLACE_DATA"));
		$('body').trigger('show_store_details', selectedstore);
	});

	function renderStoreDetails(onePlace, status) {
		//function renderData(onePlace) {
		if (!status == google.maps.places.PlacesServiceStatus.OK) {
			console.log("No details data");
			return;
		}
		$("#merchant-name").html(onePlace.name);
		$("#address_content").html(onePlace.formatted_address);
		$("#address_small").html(onePlace.formatted_address);
		if (onePlace.formatted_phone_number) {
			$("#localphone_content").html(onePlace.formatted_phone_number + "<br><small>Local</small>");
		} else {
			$("#localphone_content").html("No data");
		}

		if (onePlace.international_phone_number) {
			$("#globalphone_content").html(onePlace.international_phone_number + "<br><small>International</small>");
		} else {
			$("#globalphone_content").html("No Data");
		}

		var addrURL = "https://www.google.com/maps/embed/v1/place?key=AIzaSyDnmD4Wi-IsTFrQg7cbpExbV9-gsw5YXC0&q=" + encodeURIComponent(onePlace.formatted_address);
		$("#map_view").attr("src", addrURL);

		handleTimings(onePlace);
		handleReviews(onePlace);
		handleGallery(onePlace);
		handleURL(onePlace);

		if (onePlace.permanently_closed) {
			alert("Closed permanently");
		}

		if (onePlace.rating) {
			//alert("Rating" + onePlace.rating);
			$("#rating_text").html(onePlace.rating + " / 5");
		};

		if (onePlace.opening_hours && onePlace.opening_hours.open_now) {
			$("#store_open").attr("src", "https://cdn3.iconfinder.com/data/icons/charming-boutique-icon-set/128/open.png");
			//alert(onePlace.opening_hours.open_now);
		} else {
			$("#store_open").attr("src", "img/store_closed.png");
			//alert('closed');
		}
		$(window).trigger('resize');
		$("html, body").animate({
			scrollTop : 0
		}, "slow");

	}

	function setParallaxBanner(bannerImage) {
		//alert(bannerImage);
		if (bannerImage == undefined || !bannerImage) {
			var indx = Math.floor((Math.random() * 4) + 1);
			//bannerImage = "img/fashion/" + indx + ".jpg";
			bannerImage = getImage();
		}
		//alert("Computed... bgimage var changed.. " + bannerImage);
		$('.parallax-element').css('background', 'url(' + bannerImage + ') no-repeat center center');
		$('.parallax-element').css('background-size', 'cover');
		$(window).stellar({
			horizontalScrolling : false,
			responsive : true
		});

		updateStellars();
		$(window).trigger('resize');
	}

	function handleGallery(onePlace) {
		if (!onePlace.photos) {
			setParallaxBanner();
			return;
		}
		var photos = onePlace.photos;
		var bannerImage = undefined;
		var widest = 0;
		var images = [];
		for (var i = 0; i < photos.length; i++) {
			var imageURL = photos[i].getUrl(fullImageSize);
			if (!imageURL) {
				//console.log("NO IMAGE USE DEFAULT FOR " + results[i].name);
			} else
				console.log("GOT STRING AS " + imageURL);
			images.push(imageURL);
			if (photos[i].width > 600 && photos[i].height > 200) {
				if (photos[i].width > widest) {
					widest = photos[i].width;
					bannerImage = imageURL;
				}
			}

		}

		// Render images
		var galleryTemplate = $('#ONE_GALLERY_ITEM').html();
		var galleryHtml = Mustache.to_html(galleryTemplate, {
			images : images
		});
		$("#photo-gallery").html(galleryHtml);

		setParallaxBanner(bannerImage);
	}

	function handleURL(onePlace) {
		if (!onePlace.website) {
			$("#website_content").html("No website information available");
			$('#website_image').css('background', 'url(' + "https://cdn0.iconfinder.com/data/icons/ikooni-outline-free-basic/128/free-15-256.png" + ') no-repeat top center');
			$('#website_image').css('background-size', 'cover');
			return;
		}

		var websitePreview = 'http://img.bitpixels.com/getthumbnail?code=95254&size=200&url=' + onePlace.website;
		$('#website_image').css('background', 'url(' + websitePreview + ') no-repeat top center');
		$('#website_image').css('background-size', 'cover');
		$("#website_content").html("Visit the website for more information<br>" + onePlace.website);

		if (onePlace.website) {
			extractURL.extract(onePlace.website, showSiteMeta);
		} else {
			//$("#overview_content").html("Store in " + $.jStorage.get("SEARCH_CITY"));
		}
	}

	function showSiteMeta(siteData) {
		$("#overview_content").html("<br>" + siteData.title ? siteData.title : "");
		$("#overview_content").append("<br>" + siteData.desc ? siteData.desc : "");
	}

	function handleTimings(onePlace) {
		if (onePlace.opening_hours && onePlace.opening_hours.weekday_text) {
			var weekday_text = onePlace.opening_hours.weekday_text;
			var times = [];
			for (var i = 0; i < weekday_text.length; i++) {
				var onerow = weekday_text[i];
				var d = onerow.substring(0, onerow.indexOf(":"));
				var t = onerow.substring(onerow.indexOf(":") + 1);
				var oneItem = {
					day : d,
					times : t
				};
				times.push(oneItem);
			}

			var menuemplate = $('#TIMING_TEMPLATE').html();
			var menuHtml = Mustache.to_html(menuemplate, {
				times : times
			});

			$("#timings_content").html(menuHtml);

		} else {
			$("#timings_content").html("No timings data");
		}
	}

	function getStars(soMany) {
		var onStar = "<i class='glyphicon glyphicon-star'></i>";
		var offStar = "<i class='glyphicon glyphicon-star-empty'></i>";
		var starsText = "";
		for (var i = 0; i < soMany; i++) {
			starsText = starsText + onStar;
		}
		for (var i = soMany; i < 5; i++) {
			starsText = starsText + offStar;
		}
		return starsText;
	}

	function handleReviews(onePlace) {
		if (!onePlace.reviews) {
			return;
		}
		var reviews = onePlace.reviews;
		for (var i = 0; i < reviews.length; i++) {
			if (reviews[i].rating) {
				reviews[i].stars = getStars(reviews[i].rating);
			}
		}

		var reviewTemplate = $('#REVIEW_TEMPLATE').html();
		var reviewHtml = Mustache.to_html(reviewTemplate, {
			reviews : reviews
		});
		$("#reviews_holder").html(reviewHtml);

	}

</script>